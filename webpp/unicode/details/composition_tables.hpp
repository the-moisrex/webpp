
/**
 * Attention:
 *   Auto-generated file, don't modify this file; use the mentioned file below
 *   to re-generate this file with different options.
 *
 *   Auto generated from:                generate_composition_tables.mjs
 *   Unicode UCD Database Creation Date: 2023-08-28
 *   This file's generation date:        Fri, 23 Aug 2024 08:15:18 GMT
 *   Unicode Version:                    15.1.0
 *   Total Table sizes in this file:
 *       - in bits:       undefined
 *       - in bytes:      NaN B
 *       - in KibiBytes:  NaN KiB
 *   Some other implementations' total table size was 73.4 KiB;
 *   So I saved NaN KiB and a better a locality.
 *
 * Details about the contents of this file can be found here:
 *   UTS #15: https://www.unicode.org/reports/tr15/
 *   UTS #44: https://www.unicode.org/reports/tr44/#UnicodeData.txt
 *   IDN FAQ: https://www.unicode.org/faq/idn.html
 *
 *   UCD Database Code Points (used the get the CCC values and what not):
 *       https://www.unicode.org/Public/UCD/latest/ucd/UnicodeData.txt
 *   UCD README file (used to check the version and creation date):
 *       https://www.unicode.org/Public/UCD/latest/ucd/ReadMe.txt
 *   Decomposition Mapping syntax used in the UCD Database:
 *       https://www.unicode.org/reports/tr44/#Character_Decomposition_Mappings
 */

#ifndef WEBPP_UNICODE_COMPOSITION_TABLES_HPP
#define WEBPP_UNICODE_COMPOSITION_TABLES_HPP

#include "../../utils/bits.hpp"

#include <array>
#include <cstdint>
#include <string_view>

namespace webpp::unicode::details {



    static constexpr std::array<std::uint32_t, 1862ULL> canonical_composition_magic_table{
      4134,   119136, 0,     119137, 0,     8653,  0,      263,   0,     8655,   0,     227,   0,     265,
      0,      494,    0,     232,    7759,  7893,  0,      8654,  0,     501,    0,     234,   0,     7869,
      0,      7921,   0,     0,      2888,  257,   2892,   0,     0,     0,      0,     0,     0,     259,
      0,      551,    0,     0,      7683,  267,   492,    493,   0,     0,      0,     7713,  0,     0,
      0,      277,    7691,  279,    0,     287,   7711,   289,   0,     236,    0,     237,   0,     0,
      0,      7729,   293,   238,    0,     297,   7986,   6930,  7988,  7989,   0,     0,     314,   7743,
      7990,   7991,   324,   243,    0,     0,     0,      0,     0,     244,    241,   245,   0,     69803,
      0,      0,      0,     0,      0,     0,     0,      301,   7715,  0,      70843, 0,     0,     0,
      0,      474,    0,     0,      0,     8183,  119227, 0,     0,     119228, 0,     7745,  0,     335,
      7749,   559,    0,     228,    0,     7843,  0,      0,     70846, 8122,   0,     902,   0,     0,
      7994,   7995,   7996,  7997,   0,     235,   12466,  8157,  7998,  8158,   1143,  8136,  0,     904,
      0,      8159,   0,     905,    0,     0,     0,      462,   3922,  0,      0,     269,   12472, 8121,
      0,      8124,   0,     513,    0,     0,     0,      8120,  271,   4002,   0,     0,     0,     3927,
      0,      0,      0,     0,      0,     517,   0,      8140,  2508,  8035,   8036,  8037,  6979,  7881,
      4007,   0,      8038,  8154,   0,     906,   0,      0,     0,     0,      0,     0,     0,     0,
      12474,  7693,   7865,  246,    12476, 7887,  0,      0,     0,     8184,   7681,  908,   0,     337,
      8096,   8097,   12478, 0,      8098,  8099,  3932,   8153,  231,   0,      0,     521,   0,     0,
      0,      8152,   8100,  8101,   0,     7697,  8102,   4012,  0,     0,      291,   0,     0,     0,
      8769,   0,      8042,  8043,   8044,  8045,  119231, 7717,  7883,  0,      8046,  8047,  7731,  8058,
      0,      973,    0,     119232, 0,     0,     0,      8166,  0,     7735,   7747,  7809,  0,     3404,
      7885,   251,    0,     361,    0,     373,   7805,   8802,  8104,  8105,   0,     7721,  8106,  8107,
      0,      0,      311,   8161,   7767,  0,     0,      0,     8816,  8817,   8108,  8160,  0,     316,
      8110,   8111,   0,     326,    0,     8060,  261,    974,   8146,  8162,   912,   944,   0,     8182,
      0,      253,    8151,  8167,   378,   938,   0,      375,   281,   7929,   7825,  0,     0,     0,
      0,      0,      0,     0,      0,     0,     0,      0,     12535, 2891,   0,     8179,  0,     0,
      0,      0,      0,     119140, 0,     0,     0,      0,     0,     0,      0,     0,     7819,  7699,
      7705,   0,      8180,  0,      0,     0,     0,      0,     0,     7782,   7783,  0,     8836,  8837,
      303,    0,      0,     0,      0,     0,     0,      0,     0,     0,      0,     0,     0,     0,
      8840,   971,    0,     0,      0,     7800,  7801,   0,     7831,  252,    0,     7896,  7897,  7813,
      0,      0,      0,     367,    0,     369,   0,      7832,  0,     0,      0,     7723,  0,     0,
      345,    353,    0,     0,      0,     0,     0,      7741,  1747,  0,      529,   7755,  357,   468,
      0,      0,      0,     0,      0,     1027,  0,      1728,  0,     533,    0,     69934, 0,     3969,
      69935,  1024,   0,     7927,   0,     0,     0,      7771,  7779,  7833,   0,     0,     7846,  0,
      7844,   0,      0,     0,      0,     7789,  7909,   0,     7850,  7807,   1232,  0,     0,     506,
      0,      0,      508,   7688,   8114,  0,     0,      0,     382,   0,      537,   343,   351,   1238,
      7795,   0,      1217,  0,      0,     0,     1037,   539,   0,     355,    0,     2507,  1036,  0,
      478,    0,      0,     0,      482,   0,     979,    0,     64320, 64321,  0,     12536, 12537, 64323,
      0,      12538,  0,     0,      0,     0,     7872,   0,     7870,  7802,   1250,  0,     0,     519,
      64326,  64327,  7876,  0,      1049,  0,     64334,  0,     0,     0,      0,     7726,  0,     0,
      8820,   8821,   0,     0,      0,     0,     0,      0,     0,     0,      0,     0,     0,     0,
      1234,   0,      8824,  8825,   0,     0,     0,      0,     0,     0,      0,     0,     0,     0,
      0,      0,      64328, 1025,   0,     523,   1244,   1246,  0,     1263,   0,     0,     371,   0,
      0,      0,      3402,  1118,   0,     0,     0,      0,     12542, 0,      0,     527,   0,     0,
      0,      0,      0,     0,      0,     0,     0,      0,     8832,  1242,   1243,  0,     0,     1572,
      0,      0,      0,     7793,   7799,  0,     8928,   8929,  1252,  0,      0,     0,     0,     8930,
      0,      0,      8931,  0,      0,     0,     980,    0,     0,     0,      0,     0,     0,     12386,
      1254,   0,      0,     0,      0,     0,     0,      0,     0,     0,      64287, 0,     0,     7944,
      12389,  7938,   7939,  7940,   7941,  0,     0,      0,     0,     7942,   7943,  0,     0,     0,
      0,      7960,   0,     0,      0,     7976,  0,      7945,  0,     0,      0,     0,     0,     0,
      0,      0,      0,     1267,   0,     0,     0,      8064,  8065,  7961,   0,     8066,  8067,  7977,
      8135,   0,      0,     7687,   0,     0,     12393,  0,     2654,  8068,   8069,  0,     0,     8070,
      8071,   7695,   0,     0,      0,     0,     0,      7992,  0,     7946,   7947,  7948,  7949,  12400,
      7890,   0,      7888,  7950,   7951,  12401, 0,      417,   0,     0,      7894,  0,     0,     8008,
      0,      7993,   0,     0,      0,     0,     0,      0,     0,     0,      0,     0,     0,     1261,
      0,      8072,   2392,  0,      8708,  2393,  2394,   8009,  554,   0,      0,     0,     7733,  0,
      0,      8164,   0,     8076,   8077,  0,     0,      8078,  8079,  7739,   0,     0,     0,     7753,
      0,      0,      0,     8016,   0,     0,     0,      8814,  475,   8165,   471,   8815,  0,     0,
      0,      0,      0,     0,      0,     0,     7856,   7857,  7854,  7855,   0,     8017,  0,     0,
      0,      0,      7860,  7861,   0,     0,     0,      8713,  0,     2395,   0,     0,     8716,  0,
      0,      0,      0,     0,      0,     0,     0,      0,     0,     8032,   0,     0,     0,     0,
      192,    0,      193,   0,      0,     0,     262,    0,     194,   0,      195,   0,     264,   0,
      0,      0,      200,   8033,   7892,  0,     0,      0,     500,   0,      202,   0,     7868,  0,
      284,    0,      0,     0,      256,   0,     0,      0,     0,     0,      0,     0,     258,   0,
      3274,   0,      0,     7682,   266,   0,     274,    0,     0,     0,      7712,  0,     0,     0,
      276,    7690,   278,   2611,   286,   7710,  12403,  0,     204,   0,      205,   0,     12404, 0,
      7728,   292,    206,   0,      296,   7954,  7955,   7956,  7957,  8170,   0,     910,   7742,  432,
      210,    323,    211,   0,      0,     0,     0,      0,     212,   209,    7858,  7859,  298,   0,
      0,      0,      0,     0,      0,     0,     300,    7714,  304,   0,      0,     0,     1111,  8169,
      473,    0,      0,     0,      332,   0,     0,      8168,  0,     0,      12409, 0,     334,   7748,
      558,    8186,   12410, 911,    7797,  2908,  0,      12413, 2909,  0,      197,   7852,  7853,  7962,
      7963,   7964,   7965,  0,      203,   0,     7866,   0,     0,     0,      0,     0,     0,     0,
      0,      0,      0,     0,      0,     0,     461,    8188,  0,     0,      268,   0,     480,   481,
      0,      7862,   7863,  0,      0,     0,     0,      270,   8116,  0,      0,     0,     8132,  0,
      0,      7829,   0,     0,      516,   0,     0,      8002,  8003,  8004,   8005,  0,     7880,  7840,
      0,      0,      7684,  0,      0,     0,     0,      0,     0,     0,      0,     939,   0,     0,
      7692,   7864,   214,   0,      7772,  7773,  0,      0,     7708,  7709,   7700,  7701,  7702,  7703,
      463,    12446,  0,     0,      488,   0,     560,    561,   0,     0,      520,   0,     0,     0,
      0,      317,    0,     0,      7696,  552,   465,    0,     0,     290,    0,     0,     0,     0,
      0,      8010,   8011,  8012,   8013,  7764,  7716,   12482, 0,     340,    346,   7730,  0,     0,
      0,      0,      348,   0,      0,     0,     217,    0,     12485, 7746,   7808,  0,     12487, 7884,
      219,    0,      360,   0,      372,   7804,  0,      2524,  0,     0,      2525,  0,     0,     0,
      0,      310,    0,     7766,   0,     0,     0,      7768,  8775,  0,      362,   0,     315,   0,
      0,      0,      325,   0,      3955,  260,   0,      0,     0,     0,      7814,  8048,  7922,  940,
      12489,  0,      0,     377,    0,     8118,  6971,   280,   7928,  7824,   0,     0,     8173,  8050,
      3957,   941,    0,     8052,   6973,  942,   8129,   12496, 6976,  6977,   0,     8134,  0,     8777,
      0,      8113,   562,   8115,   0,     0,     0,      0,     0,     8112,   0,     7818,  7698,  7704,
      1570,   379,    70476, 0,      0,     0,     0,      2527,  0,     8131,   0,     0,     0,     302,
      0,      0,      0,     0,      0,     8054,  0,      943,   1571,  0,      1573,  0,     0,     8150,
      0,      0,      0,     0,      0,     1262,  0,      0,     69786, 0,      7910,  8056,  69788, 972,
      0,      0,      366,   0,      7760,  7761,  7762,   7763,  0,     8145,   7722,  0,     0,     344,
      352,    0,      0,     8144,   0,     0,     7740,   0,     0,     528,    7754,  356,   467,   0,
      0,      3987,   0,     0,      0,     0,     0,      0,     532,   0,      0,     8018,  8019,  8020,
      8021,   0,      7926,  0,      0,     8022,  8023,   7778,  0,     7878,   7879,  0,     0,     0,
      0,      0,      0,     0,      7788,  7908,  0,      0,     7806,  7816,   0,     0,     0,     0,
      0,      0,      0,     0,      0,     0,     0,      381,   0,     536,    342,   350,   0,     7794,
      0,      0,      0,     1264,   0,     0,     538,    0,     354,   0,      0,     0,     0,     1266,
      0,      0,      0,     0,      0,     1268,  8027,   970,   8029,  0,      514,   7924,  0,     0,
      8031,   0,      0,     0,      0,     0,     12500,  0,     0,     0,      0,     0,     518,   12502,
      0,      0,      0,     0,      0,     12503, 0,      1258,  1259,  0,      0,     2964,  0,     0,
      0,      0,      0,     64300,  0,     0,     0,      0,     0,     64301,  0,     1272,  0,     0,
      8876,   0,      0,     0,      0,     0,     0,      0,     0,     1260,   0,     0,     0,     0,
      0,      0,      0,     0,      12505, 0,     3271,   0,     0,     12508,  12506, 370,   3272,  0,
      0,      12509,  0,     0,      0,     0,     0,      0,     0,     0,      526,   0,     0,     7900,
      7901,   7898,   7899,  0,      0,     8172,  0,      0,     0,     7904,   7905,  0,     0,     0,
      0,      0,      7792,  7798,   8877,  8878,  0,      8025,  0,     8879,   0,     0,     3275,  0,
      0,      0,      0,     1104,   0,     0,     0,      0,     0,     0,      0,     0,     0,     0,
      7847,   0,      7845,  0,      0,     8040,  0,      0,     0,     0,      7851,  0,     1233,  0,
      8602,   507,    0,     12436,  8603,  7689,  0,      0,     0,     0,      0,     0,     2396,  8041,
      0,      1239,   8622,  0,      1218,  70475, 0,      0,     1117,  0,      0,     0,     0,     0,
      1116,   0,      7912,  0,      0,     0,     483,    0,     0,     0,      7918,  7781,  0,     0,
      0,      0,      7686,  0,      64285, 0,     0,      0,     7873,  0,      7871,  0,     1251,  7706,
      7694,   0,      0,     0,      7877,  0,     3958,   3960,  12366, 0,      0,     0,     12368, 7727,
      0,      0,      0,     7902,   7903,  2345,  416,    64303, 0,     0,      2398,  0,     0,     0,
      0,      0,      1235,  64298,  0,     0,     0,      0,     0,     64299,  0,     0,     2399,  0,
      0,      0,      0,     0,      0,     1105,  0,      0,     1245,  1247,   0,     64304, 64305, 0,
      8119,   64306,  64307, 530,    7849,  0,     0,      0,     64332, 0,      0,     0,     71992, 64308,
      64309,  0,      534,   64310,  0,     0,     0,      0,     0,     0,      0,     0,     7906,  7907,
      0,      0,      0,     8141,   3546,  8142,  0,      0,     0,     0,      1253,  8143,  0,     0,
      0,      0,      0,     0,      7916,  3549,  0,      0,     7736,  7737,   0,     0,     0,     0,
      119134, 0,      1255,  8941,   0,     64312, 64313,  0,     0,     64314,  3548,  0,     7875,  0,
      0,      7936,   0,     7970,   7971,  7972,  7973,   64316, 0,     0,      0,     7974,  7975,  0,
      0,      0,      0,     7952,   0,     7913,  6918,   7968,  0,     7937,   6920,  0,     0,     7919,
      0,      119135, 0,     0,      0,     0,     0,      0,     0,     8080,   8081,  7953,  0,     8082,
      8083,   7969,   0,     0,      0,     0,     0,      0,     0,     0,      0,     8084,  8085,  0,
      0,      8086,   8087,  0,      0,     0,     12372,  0,     0,     7984,   0,     7978,  6922,  7980,
      7981,   0,      6924,  0,      2649,  7982,  7983,   0,     12376, 0,      3945,  0,     7895,  0,
      6926,   8000,   0,     7985,   7784,  7785,  2356,   0,     3907,  0,      0,     0,     0,     0,
      0,      0,      0,     8088,   8089,  0,     8740,   8090,  8091,  8001,   555,   0,     0,     0,
      0,      0,      0,     0,      8742,  8092,  8093,   0,     0,     8094,   8095,  0,     0,     0,
      12380,  0,      0,     3144,   7790,  0,     0,      0,     2651,  0,      476,   0,     472,   0,
      0,      12460,  12384, 71098,  71099, 3019,  0,      7917,  0,     0,      495,   0,     0,     12462,
      0,      70844,  0,     12464,  0,     0,     0,      0,     0,     0,      0,     0,     0,     0,
      3917,   0,      0,     0,      0,     0,     0,      0,     0,     0,      0,     0,     0,     0};

    struct composition {
        static constexpr std::uint16_t chunk_mask  = 0x3FU;
        static constexpr std::size_t   chunk_size  = 64U;
        static constexpr std::uint8_t  chunk_shift = 6U;


        static constexpr std::size_t cp1_mask                = 0x3FFFU;
        static constexpr std::size_t cp2_mask                = 0xFFFU;
        static constexpr std::size_t interleaved_magic_mask  = 0x555FFFU;
        static constexpr std::size_t interleaved_magic_compl = 0xCB9U;
        static constexpr std::size_t last_mapped_bucket      = 0x747U;

        /// This is a magical formula that absolutely does not make sense, but it works because math is
        /// magical. This will merge the 2 code points into one single value that then can be used to get the
        /// position of the values in the values table.
        template <typename CharT = char32_t>
        [[nodiscard]] static constexpr std::size_t magic_merge(CharT cp1, CharT cp2) noexcept {
            cp1 &= cp1_mask;
            cp2 &= cp2_mask;
            auto const intlvd =
              webpp::interleave_bits(static_cast<std::uint16_t>(cp1), static_cast<std::uint16_t>(cp2));
            auto const merged = (intlvd & interleaved_magic_mask) - interleaved_magic_compl;
            return (((merged >> chunk_shift) % last_mapped_bucket) << chunk_shift) | (merged & chunk_mask);
        }
    };


} // namespace webpp::unicode::details

#endif // WEBPP_UNICODE_COMPOSITION_TABLES_HPP
